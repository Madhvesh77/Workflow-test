on:
  push:
    branches:
      - "main"
  pull_request:
    branches:
      - "**"
jobs:
  GoodJob:
    runs-on: 'ubuntu-latest'
    steps:
      - name: List commits on the pull request
        run: |
          response=$(curl --request GET --url 'https://api.github.com/repos/${{ github.repository }}/pulls/${{ github.event.pull_request.number }}/commits' --header 'Authorization: token ${{ secrets.GITHUB_TOKEN }}' --header 'Accept: application/vnd.github.v3+json' --header 'Content-Type: application/json')
          echo "Response: $response"
          echo $response > response.json

      - name: Get latest commit
        run: |
          echo "Get length of the array:"
          length=$(jq 'length' response.json)
          
          echo "Get index of the latest commit:"
          index=$(($length - 1))
          
#          echo "Get context of the latest commit:"
#          latest_commit=$(jq --argjson index $index '.[$index]' response.json)
#          echo "$latest_commit"
#
#          echo "Get commit message of the latest commit:"
#          latest_commit_message=$(echo "$latest_commit" | jq -r '.commit.message')
#          echo "$latest_commit_message"
#
#          echo "Get commit SHA of the latest commit:"
#          latest_commit_sha=$(echo "$latest_commit" | jq -r '.sha')
#          echo "$latest_commit_sha"

      - name: print gihub.event stuff
        run: |
          echo "${{ toJson(github.event) }}"
          echo "pull req = ${{ toJson(github.event.pull_request) }}"
